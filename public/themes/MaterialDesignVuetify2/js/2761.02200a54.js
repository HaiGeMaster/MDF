"use strict";(self["webpackChunkMaterialDesignForum"]=self["webpackChunkMaterialDesignForum"]||[]).push([[2761],{7988:function(e,t,n){n.d(t,{Z:function(){return c}});var o=n(4780),a=n(3162),l=n(8561),s=function(){var e=this,t=e._self._c;return t(a.Z,{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],key:"new-comment",class:["new-comment",{"rounded-xxl":e.dialog_mode&&!e.$store.getters.GetDevice.mobile,"rounded-t-xxl":!e.dialog_mode&&!e.$store.getters.GetDevice.mobile,"rounded-0":e.$store.getters.GetDevice.mobile,"glass-container":e.new_comment_reply_need_glass_container,"layout-colourless":!e.new_comment_reply_need_glass_container}],attrs:{elevation:e.new_comment_reply_elevation}},[t(l.Z,{staticStyle:{"margin-right":"15px"},attrs:{disabled:e.Submitting,label:e.label||e.$t("Message.Components.Comments.NewCommentOrReply.WriteYourComment"),loading:e.Submitting,"hide-details":"",flat:""},on:{keydown:t=>{13!=t.keyCode||t.shiftKey||(t.preventDefault(),e.OnSubmit())},focus:function(t){return e.$emit("on_focus")},blur:function(t){return e.$emit("on_blur")}},model:{value:e.SubmitText,callback:function(t){e.SubmitText=t},expression:"SubmitText"}}),t(o.Z,{class:["submit"],attrs:{depressed:"",rounded:"",color:"primary",loading:e.is_loading},on:{click:function(t){return e.OnSubmit()}}},[e._v(" "+e._s(e.Submitting?e.$t("Message.Components.Comments.NewCommentOrReply.Publlishing"):e.$t("Message.Components.Comments.NewCommentOrReply.Publish"))+" ")])],1)},i=[],m=n(7079),r={name:"new-comment-reply",props:{show:{type:Boolean,default:!1},label:{type:String,default:""},new_comment_reply_need_glass_container:{type:Boolean,default:!0},new_comment_reply_rounded_t_or_b:{type:String,default:"t"},new_comment_reply_elevation:{type:String,default:"0"},commentable_type:{type:String,default:""},commentable_id:{type:Number,default:0},replyable_type:{type:String,default:""},replyable_id:{type:Number,default:0},replyable_user_id:{type:Number,default:0},replyable_comment_id:{type:Number,default:0},dialog_mode:{type:Boolean,default:!1}},data(){return{SubmitText:"",Submitting:!1,is_loading:!1}},methods:{OnSubmit(){this.$store.getters["User/GetIsLogin"]||this.$store.dispatch("Dialog/Set_LoginDialog",!0),"question"==this.commentable_type||"answer"==this.commentable_type||"article"==this.commentable_type?this.AddComment():"comment"!=this.replyable_type&&"reply"!=this.replyable_type||this.AddReply()},async AddComment(){this.is_loading=!0;const e=await(0,m.X6)({commentable_id:this.commentable_id,commentable_type:this.commentable_type,content:this.SubmitText,user_token:this.$G_GetUserToken()});1==e.data.is_add?(this.is_loading=!1,this.SubmitText="",this.$emit("return_update_comments",e.data.comment)):(this.is_loading=!1,this.IsEmpty=!0)},async AddReply(){this.is_loading=!0;const e=await(0,m.rY)({replyable_id:this.replyable_id,replyable_type:this.replyable_type,content:this.SubmitText,user_token:this.$G_GetUserToken(),replyable_user_id:this.replyable_user_id,replyable_comment_id:this.replyable_comment_id});1==e.data.is_add?(this.is_loading=!1,this.SubmitText="",this.$emit("add_reply",e.data.reply)):(this.is_loading=!1,this.IsEmpty=!0)}}},_=r,d=n(1001),p=(0,d.Z)(_,s,i,!1,null,null,null),c=p.exports},2761:function(e,t,n){n.d(t,{Z:function(){return I}});var o=n(3162),a=n(8112),l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mc-comments"},[t(o.Z,{class:["comments-wrapper",{"glass-container":e.need_glass_container,"layout-colourless":!e.need_glass_container}],attrs:{outlined:e.need_outlined,rounded:!e.need_rounded||e.$store.getters.GetDevice.mobile?"0":"xxl",elevation:e.card_list_elevation}},[e._l(e.data,(function(n,o){return[0!=o?t(a.Z):e._e(),t("CommentItem",{attrs:{classes:e.item_classes,comment:n},on:{update_comment_reply_count:t=>{e.data[o].reply_count=t}}})]})),t("Empty",{attrs:{show:null==e.data}}),e.external_loading||null==e.data?e._e():t("Loading",{attrs:{loading:e.is_loading,pagination:e.pagination},on:{autoload:e.GetComments}})],2),e.external_loading&&null!=e.data?t("Loading",{attrs:{loading:e.is_loading,pagination:e.pagination},on:{autoload:e.GetComments}}):e._e(),t("NewCommentOrReply",{attrs:{dialog_mode:e.dialog_mode,show:e.show_new_comment,new_comment_reply_need_glass_container:e.new_comment_reply_need_glass_container,new_comment_reply_rounded_t_or_b:e.new_comment_reply_rounded_t_or_b,new_comment_reply_elevation:"10",commentable_type:e.commentable_type,commentable_id:e.commentable_id},on:{return_update_comments:e.return_update_comments}})],1)},s=[],i=n(4780),m=n(9618),r=n(3231),_=function(){var e=this,t=e._self._c;return null!=e.comment?t(o.Z,{class:[e.classes,"item"],attrs:{elevation:"0"}},[null!=e.comment?t("UserLine",{attrs:{user:e.comment.user,time:e.$G_TimeStampToDateTime(e.comment.update_time)}}):e._e(),t("div",{staticClass:"content"},[e._v(" "+e._s(e.comment.content)+" ")]),t("div",{staticClass:"actions"},[t("VoteButton",{attrs:{vote:e.comment.vote,vote_up_count:e.comment.vote_up_count,vote_down_count:e.comment.vote_down_count}}),t("div",{staticStyle:{"margin-left":"8px"}}),t("IconButton",{attrs:{icon:"mdi-reply",text:e.$t("Message.Components.Comments.Item.Reply"),smalls:!1},on:{icon_button_click:function(t){e.new_comment_or_reply_show=!e.new_comment_or_reply_show}}}),t(r.Z),null!=e.comment?t("OptionsButton",{attrs:{type:"comment",item:e.comment}}):e._e()],1),t("NewCommentOrReply",{attrs:{show:e.new_comment_or_reply_show,new_comment_reply_need_glass_container:!1,replyable_id:e.comment.comment_id,replyable_type:"comment",replyable_comment_id:e.comment.comment_id,replyable_user_id:e.comment.user.user_id,label:e.$t("Message.Components.Comments.NewCommentOrReply.WriteYourReply")},on:{add_reply:e.add_reply}}),e.comment.reply_count>0?t(i.Z,{class:["reply_count",{"show-replies":e.show_replies}],attrs:{loading:e.is_loading,text:""},on:{click:function(t){e.show_replies=!e.show_replies}}},[t(m.Z,[e._v("mdi-menu-down")]),t("span",[e._v(" "+e._s(e.show_replies?e.$t("Message.Components.Comments.Item.CollapseReply"):e.$t("Message.Components.Comments.Item.ViewNReplies",{value:e.comment.reply_count}))+" ")])],1):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.show_replies,expression:"show_replies"}],staticClass:"replies"},[e._l(e.data,(function(n,o){return[t("div",[0!=o?t(a.Z):e._e(),t("Reply",{attrs:{reply:n,comment:e.comment},on:{add_reply:e.add_reply}})],1)]})),null!=e.pagination.next?t(i.Z,{class:["reply_more"],attrs:{text:""},on:{click:function(t){return e.GetData()}}},[t(m.Z,[e._v("mdi-subdirectory-arrow-right")]),null!=e.data?t("span",[e._v(" "+e._s(e.$t("Message.Components.Comments.Item.ShowMoreReplies"))+" "+e._s(`(${e.data.length}/${e.pagination.total})`)+" ")]):e._e()],1):e._e()],2)],1):e._e()},d=[],p=n(8210),c=n(9665),u=n(937),y=n(6519),h=function(){var e=this,t=e._self._c;return null!=e.reply?t("div",{staticClass:"item reply"},[t("UserLine",{attrs:{user:e.local_reply.user,is_reply:null!=e.local_reply.replyable_user&&"reply"==e.local_reply.replyable_type,reply_user:e.local_reply.replyable_user,time:e.$G_TimeStampToDateTime(e.local_reply.update_time),small_avatar:!0}}),t("div",{staticClass:"content"},[e._v(e._s(e.local_reply.content))]),t("div",{staticClass:"actions"},[t("VoteButton",{attrs:{vote:e.local_reply.vote,vote_up_count:e.local_reply.vote_up_count,vote_down_count:e.local_reply.vote_down_count}}),t("IconButton",{attrs:{icon:"mdi-reply",text:e.$t("Message.Components.Comments.Item.Reply"),smalls:!1},on:{icon_button_click:function(t){e.new_comment_or_reply_show=!e.new_comment_or_reply_show}}}),t(r.Z),null!=e.reply?t("OptionsButton",{attrs:{type:"reply",item:e.reply}}):e._e()],1),null!=e.reply?t("NewCommentOrReply",{attrs:{show:e.new_comment_or_reply_show,new_comment_reply_need_glass_container:!1,replyable_id:e.local_reply.reply_id,replyable_type:null!=e.local_reply.replyable_user||"comment"==e.local_reply.replyable_type?"reply":"comment",replyable_user_id:e.local_reply.user.user_id,replyable_comment_id:"comment"==e.local_reply.replyable_type?e.local_reply.replyable_id:e.local_comment.comment_id,label:e.$t("Message.Components.Comments.Item.ReplyTo",{value:e.local_reply.user.username})},on:{add_reply:e.add_reply}}):e._e()],1):e._e()},g=[],w=n(7988),b={name:"comments-reply",components:{UserLine:p["default"],VoteButton:c["default"],OptionsButton:y["default"],IconButton:u.Z,NewCommentOrReply:w.Z},props:{reply:{type:Object,default:null},comment:{type:Object,default:null}},computed:{ReturnUpdateGetReplyUpdate(){return this.$store.getters["Update/GetReplyUpdate"]}},data(){return{editDialog:!1,editDialog_id:0,editDialog_content:"",new_comment_or_reply_show:!1,local_reply:null,local_comment:null}},methods:{add_reply(e){this.new_comment_or_reply_show=!1,this.$emit("add_reply",e)}},created(){this.local_reply=this.reply,this.local_comment=this.comment,this.$forceUpdate()},watch:{ReturnUpdateGetReplyUpdate(e){e.reply_id==this.local_reply.reply_id&&(this.local_reply=e,this.$forceUpdate())},reply:{handler(e){this.local_reply=e,this.$forceUpdate()},deep:!0},comment:{handler(e){this.local_comment=e,this.$forceUpdate()},deep:!0}}},f=b,C=n(1001),v=(0,C.Z)(f,h,g,!1,null,null,null),$=v.exports,R=n(7079),G={name:"comments-item",props:{classes:{type:String,default:"glass-container"},comment:{type:Object,default:null}},components:{UserLine:p["default"],VoteButton:c["default"],IconButton:u.Z,OptionsButton:y["default"],Reply:$,NewCommentOrReply:w.Z},data(){return{show_replies:!1,new_comment_or_reply_show:!1,is_loading:!1,data:null,pagination:{page:0,per_page:20,total:0,pages:0,previous:0,next:1},order:"-update_time"}},methods:{add_reply(e){this.new_comment_or_reply_show=!1,null==this.data?(this.GetReplys(),this.show_replies=!0):this.data.unshift(e),this.$emit("update_comment_reply_count",this.pagination.total),this.$forceUpdate()},async GetReplys(){this.is_loading=!0;const e=await(0,R.Pe)({replyable_comment_id:this.comment.comment_id,order:this.order,page:this.pagination.next,user_token:this.$G_GetUserToken()});1==e.data.is_get?(null==this.data?this.data=e.data.data:this.$G_FilterSameItems("comment_id",this.data,e.data.data),null==this.data?this.data=e.data.data:this.$G_FilterSameItems("reply_id",this.data,e.data.data),this.pagination=e.data.pagination,this.is_loading=!1):this.is_loading=!1}},watch:{show_replies(e){1==e&&this.GetReplys()}}},S=G,x=(0,C.Z)(S,_,d,!1,null,null,null),T=x.exports,U=n(9387),O=n(3104),Z={name:"comments",props:{show_new_comment:{type:Boolean,default:!0},external_loading:{type:Boolean,default:!1},need_glass_container:{type:Boolean,default:!0},need_rounded:{type:Boolean,default:!0},need_outlined:{type:Boolean,default:!0},new_comment_reply_need_glass_container:{type:Boolean,default:!0},new_comment_reply_rounded_t_or_b:{type:String,default:"t"},item_classes:{type:String,default:"glass-container"},commentable_type:{type:String,default:"question"},commentable_id:{type:Number,default:0},order:{type:String,default:"-update_time"},card_list_elevation:{type:String,default:"0"},dialog_mode:{type:Boolean,default:!1}},components:{CommentItem:T,Loading:U["default"],Empty:O["default"],NewCommentOrReply:w.Z},computed:{ReturnUpdateGetCommentUpdate(){return this.$store.getters["Update/GetCommentUpdate"]}},data(){return{is_loading:!1,data:null,pagination:{page:0,per_page:20,total:0,pages:0,previous:0,next:1}}},methods:{async GetComments(){const e=(0,R.dA)();if(console.log("ARTICLE_COMMENTS",e),null!==e)return this.data=e.data,void(this.pagination=e.pagination);if(this.is_loading)return;this.is_loading=!0;const t=await(0,R.sk)({commentable_id:this.commentable_id,commentable_type:this.commentable_type,order:this.order,page:this.pagination.next,user_token:this.$G_GetUserToken()});1==t.data.is_get?(null==this.data?this.data=t.data.data:this.$G_FilterSameItems("comment_id",this.data,t.data.data),this.pagination=t.data.pagination,this.is_loading=!1):this.is_loading=!1},return_update_comments(e){this.ResetData(),this.GetComments(),this.$emit("return_update_comments",e),this.$forceUpdate()},ResetData(){this.data=null,this.pagination={page:0,per_page:20,total:0,pages:0,previous:0,next:1}}},created(){null!=window.G_ARTICLE_COMMENTS?(this.data=window.G_ARTICLE_COMMENTS.data,this.pagination=window.G_ARTICLE_COMMENTS.pagination):this.GetComments()},watch:{order(e){""!=e&&(this.ResetData(),this.GetComments())},commentable_id(e){0!=e&&(this.ResetData(),this.GetComments())},commentable_type(e){""!=e&&(this.ResetData(),this.GetComments())},ReturnUpdateGetCommentUpdate(e){this.ResetData(),this.GetComments()}}},k=Z,B=(0,C.Z)(k,l,s,!1,null,null,null),I=B.exports}}]);